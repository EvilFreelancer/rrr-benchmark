# üá∑üá∫ Russian Router Ranking (RRR) Benchmark

Russian Router Ranking (RRR) ‚Äî —ç—Ç–æ –±–µ–Ω—á–º–∞—Ä–∫ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ LLM-–º–æ–¥–µ–ª–µ–π –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é/–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é
—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (LLM) –ø–æ
–∑–∞–¥–∞—á–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤. –ú–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Å–ø–∏—Å–∫—É –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –∏
–æ–±—ä—è—Å–Ω–∏—Ç—å —Å–≤–æ–π –≤—ã–±–æ—Ä.

> **–í–Ω–∏–º–∞–Ω–∏–µ:** –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ Ollama, –æ–¥–Ω–∞–∫–æ, –≤ –±—É–¥—É—â–µ–º –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å
> –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –¥—Ä—É–≥–∏—Ö OpenAI-–ø–æ–¥–æ–±–Ω—ã—Ö API (—Ç–∞–∫–∏—Ö –∫–∞–∫ llama.cpp, vLLM, OpenAI, LiteLLM –∏ –¥—Ä.).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –°–∫–∞—á–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/EvilFreelancer/rrr-benchmark.git
   cd rrr-benchmark
   ```
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`, –≤ –Ω—ë–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å `OLLAMA_BASE_URL` (–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ —Å Ollama):
   ```bash
   cp .env.dist .env
   ```
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   python -m venv .venv
   source .venv/bin/activate
   pip install -r requirements.txt
   ```
4. (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–∫–∞–∂–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `MODEL_LIST` –≤ —Ñ–∞–π–ª–µ [main.py](./main.py).
5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:
   ```bash
   python main.py
   ```
   > ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—â–µ–Ω–Ω—ã–π Ollama-—Å–µ—Ä–≤–µ—Ä.
6. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ CSV-—Ñ–∞–π–ª—ã –ø–æ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏.

## –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

- –ù–∞ –≤—Ö–æ–¥ –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –ø–æ–¥–∞—ë—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ (messages) –∏ —Å–ø–∏—Å–æ–∫ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (routes).
- –ú–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–∞—Ä—à—Ä—É—Ç–∞ –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å —Å–≤–æ–π –≤—ã–±–æ—Ä.
- –í –æ—Ç–≤–µ—Ç–µ –æ–∂–∏–¥–∞–µ—Ç—Å—è JSON-–æ–±—ä–µ–∫—Ç —Å –¥–≤—É–º—è –∫–ª—é—á–∞–º–∏: reasoning (–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ) –∏ route_id (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ).

### –ü—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```json
{
  "messages": [
    {"role": "assistant", "content": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ö–∞–∫ —è –º–æ–≥—É –≤–∞–º –ø–æ–º–æ—á—å?"},
    {"role": "user", "content": "–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–∞—à –æ—Ñ–∏—Å?"}
  ],
  "routes": [
    {"id": 3519, "sense": "–ü—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ –≤ –≤–∏–¥—É –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∞–±–æ–Ω–µ–Ω—Ç–∞"},
    {"id": 4630, "sense": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä–∞—Ñ–∏–∫–µ —Ä–∞–±–æ—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏"},
    {"id": 2198, "sense": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–¥—Ä–µ—Å–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏"},
    {"id": 8142, "sense": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∞–∫—Ü–∏—è—Ö –∏ —Å–ø–µ—Ü –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö"},
    {"id": 9821, "sense": "–ü—Ä–æ—â–∞–Ω–∏–µ —Å –∞–±–æ–Ω–µ–Ω—Ç–æ–º –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞"}
  ],
  "rightStepId": 2198
}
```

## –ü—Ä–∏–º–µ—Ä —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ –º–æ–¥–µ–ª–∏

–í –º–æ–¥–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π, –≥–¥–µ –ø–µ—Ä–≤—ã–º –∏–¥—ë—Ç system prompt —Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º –º–∞—Ä—à—Ä—É—Ç–æ–≤, –∞ –¥–∞–ª–µ–µ ‚Äî –∏—Å—Ç–æ—Ä–∏—è
–¥–∏–∞–ª–æ–≥–∞. –ü—Ä–∏–º–µ—Ä:

```json
[
  {
    "role": "system",
    "content": "–¢—ã –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤...\n\n–ú–∞—Ä—à—Ä—É—Ç—ã:\n3519 - –ü—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ –≤ –≤–∏–¥—É –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∞–±–æ–Ω–µ–Ω—Ç–∞\n4630 - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä–∞—Ñ–∏–∫–µ —Ä–∞–±–æ—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏\n2198 - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–¥—Ä–µ—Å–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏\n8142 - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∞–∫—Ü–∏—è—Ö –∏ —Å–ø–µ—Ü –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö\n9821 - –ü—Ä–æ—â–∞–Ω–∏–µ —Å –∞–±–æ–Ω–µ–Ω—Ç–æ–º –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞"
  },
  {"role": "assistant", "content": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ö–∞–∫ —è –º–æ–≥—É –≤–∞–º –ø–æ–º–æ—á—å?"},
  {"role": "user", "content": "–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–∞—à –æ—Ñ–∏—Å?"}
]
```

### –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏

```json
{
  "reasoning": "User asks for the office address, this mean relevant route is about address.",
  "route_id": 2198
}
```

### –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ messages –∏ routes.
2. –ú–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å JSON —Å reasoning –∏ route_id.
3. route_id —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º (rightStepId). –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Äî –æ—Ç–≤–µ—Ç –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –≤–µ—Ä–Ω—ã–π.
4. –°—á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏.

## –î–∞—Ç–∞—Å–µ—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–î–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π, –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ Hugging
Face: [evilfreelancer/rrr-benchmark](https://huggingface.co/datasets/evilfreelancer/rrr-benchmark)

–°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —ç—Ç–æ—Ç –¥–∞—Ç–∞—Å–µ—Ç —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `datasets`.

## System Prompt

System prompt, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `structured_router.py` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
`SYSTEM_PROMPT`. –û–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–¥–∞—á—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.

–ü—Ä–∏–º–µ—Ä system prompt (—Ñ—Ä–∞–≥–º–µ–Ω—Ç):

```
–¢—ã –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é
–¥–∏–∞–ª–æ–≥–∞ –∏ –≤—Ö–æ–¥–Ω–æ–π –∑–∞–ø—Ä–æ—Å –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π route_id –∏–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤.
...
–í–ê–ñ–ù–û:
- **–ù–µ –¥–æ–±–∞–≤–ª—è–π –ù–ò–ö–ê–ö–ò–• –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, markdown, html, –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, —Å—Ö–µ–º.**
- –í–µ—Ä–Ω–∏ **–¢–æ–ª—å–∫–æ JSON-–æ–±—ä–µ–∫—Ç** –≤–∏–¥–∞:

{"reasoning": "...", "route_id": N}
...
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.12+
- –°–º. `requirements.txt`

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π [MIT License](./LICENSE).
